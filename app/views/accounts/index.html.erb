<% provide(:title, 'Accounts Listing') %>

<div class="row">
  <div class="small-12 small-centered columns">

    <h1><%= "#{current_company.name} Accounts Listing" %></h1>

    <table>
      <thead>
        <tr>
          <th><%= 'Account'.pluralize(@accounts.count) %></th>
          <th>Contact name</th>
          <th>Address</th>
          <th>Phone</th>
          <th>Fax</th>
          <th>Email</th>
          <th>All Services Invoiced</th>
          <th>All Invoices P.I.F.</th>
          <th>Invoices</th>
          <th>User status</th>
          <th>Edit</th>
          <th>Destroy</th>
        </tr>
      </thead>

      <tbody>
      <% @accounts.each do |account| %>
        <tr>
          <td><%= link_to account.name, account %></td>
          <td><%= account.user.name %></td>
          <td><%= account.full_address %></td>
          <td><%= account.phone %></td>
          <td><%= account.fax %></td>
          <td><%= mail_to account.user.email %></td>
          <td><%= account.all_services_invoiced? %></td>
          <td><%= account.paid_in_full? %></td>
          <td class="center_cell">
            <%= link_to invoices_path(account_id: account.id) do %>
              <i class="miscellaneous fi-book"></i>
            <% end %>
          </td>
          <td><%= render 'user_status', account: account %></td>
          <td class="center_cell">
            <%= link_to edit_account_path(account) do %>
              <i class="page fi-page-edit"></i>
            <% end %>
          </td>
          <td class="center_cell">
            <%= link_to account, method: :delete, confirm: 'Are you sure? This will permanently DELETE your ACCOUNT information and all SERVICES, INVOICES, and PAYMENTS applied to the ACCOUNT!'  do %>
              <i class="general fi-x"></i>
            <% end %>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>

    <%= paginate @accounts %>

    <br>

    <%= link_to 'Create new account', new_account_path, class: 'small button radius' %>

  </div>
</div>
