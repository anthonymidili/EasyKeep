<% provide(:title, 'Quarterly Report') %>

<div class="row">
  <div class="small-12 columns">

    <h1><%= current_company.name %> <small>Quarterly Report</small></h1>

    <div class="small-12 columns">
      <ul class="small-text no_bullets">
        <li><label><b>Address: </b><%= current_company.full_address %></label></li>
        <li><label><b>Phone: </b><%= current_company.phone %></label></li>
        <% if current_company.fax.present? %>
          <li><label><b>Fax: </b><%= current_company.fax %></label></li>
        <% end %>
        <li><label><b>Email: </b><%= current_company.owner_email %></label></li>
      </ul>
    </div>

    <%= render 'view_quarter_by_form' %>

    <table>
      <thead>
      <tr>
        <th><%= 'Account'.pluralize(@accounts.count) %></th>
        <th><%= month_in_quarter_date(0).strftime('%B') %> totals</th>
        <th><%= month_in_quarter_date(1).strftime('%B') %> totals</th>
        <th><%= month_in_quarter_date(2).strftime('%B') %> totals</th>
        <th>Account totals</th>
      </tr>
      </thead>

      <tbody>
      <% @accounts.each do |account| %>
        <tr>
          <td><%= account.name %></td>
          <td><%= number_to_currency(account.account_month_total(month_in_quarter_date(0))) %></td>
          <td><%= number_to_currency(account.account_month_total(month_in_quarter_date(1))) %></td>
          <td><%= number_to_currency(account.account_month_total(month_in_quarter_date(2))) %></td>
          <td><%= number_to_currency(account.account_quarter_total(active_date, view_quarter)) %></td>
        </tr>
      <% end %>

      <tr class="divider-line">
        <td><b>Totals</b></td>
        <td><b><%= number_to_currency(current_company.company_month_total(month_in_quarter_date(0))) %></b></td>
        <td><b><%= number_to_currency(current_company.company_month_total(month_in_quarter_date(1))) %></b></td>
        <td><b><%= number_to_currency(current_company.company_month_total(month_in_quarter_date(2))) %></b></td>
        <td class="red_text"><b><%= number_to_currency(@company.sum_quarter(active_date, view_quarter)) %></b></td>
      </tr>
      </tbody>
    </table>

    <div class="row">
      <div class="small-12 columns total_amount">
        <ul class="inline-list">
          <li>
            <label><%= "#{for_quarter} quarter total:" %>
              <span><%= number_to_currency(@company.sum_quarter(active_date, view_quarter)) %></span></label>
          </li>
          <li>
            <label>Taxes applied to total:
              <span><%= number_to_currency(@company.taxes_applied(active_date, view_quarter)) %></span></label>
          </li>
        </ul>
      </div>
    </div>

  </div>
</div>
